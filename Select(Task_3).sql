-- Количество исполнителей в каждом жанре
SELECT Жанры.Название AS Жанр, COUNT(ИсполнителиЖанры.Исполнитель_id) AS Количество
FROM Жанры
LEFT JOIN ИсполнителиЖанры ON Жанры.Жанр_id = ИсполнителиЖанры.Жанр_id
GROUP BY Жанры.Название;

-- Количество треков, вошедших в альбомы 2019–2020 годов
SELECT COUNT(*) AS Количество
FROM Треки
JOIN Альбомы ON Треки.Альбом_id = Альбомы.Альбом_id
WHERE Альбомы.ГодВыпуска BETWEEN 2019 AND 2020;

-- Средняя продолжительность треков по каждому альбому
SELECT Альбомы.Название AS Альбом, AVG(Треки.Длительность) AS СредняяПродолжительность
FROM Альбомы
JOIN Треки ON Альбомы.Альбом_id = Треки.Альбом_id
GROUP BY Альбомы.Название;

-- Все исполнители, которые не выпустили альбомы в 2020 году
SELECT Исполнители.Имя
FROM Исполнители
WHERE Исполнители.Исполнитель_id NOT IN (
    SELECT DISTINCT ИсполнителиАльбомы.Исполнитель_id
    FROM Альбомы
    JOIN ИсполнителиАльбомы ON Альбомы.Альбом_id = ИсполнителиАльбомы.Альбом_id
    WHERE Альбомы.ГодВыпуска = 2020
);

-- Названия сборников, в которых присутствует конкретный исполнитель Король и Шут
SELECT DISTINCT Сборники.Сборник_id, Сборники.Название
FROM Сборники
JOIN ТрекиВСборниках ON Сборники.Сборник_id = ТрекиВСборниках.Сборник_id
JOIN Треки ON ТрекиВСборниках.Трек_id = Треки.Трек_id
JOIN Альбомы ON Треки.Альбом_id = Альбомы.Альбом_id
JOIN ИсполнителиАльбомы ON Альбомы.Альбом_id = ИсполнителиАльбомы.Альбом_id
JOIN Исполнители ON ИсполнителиАльбомы.Исполнитель_id = Исполнители.Исполнитель_id
WHERE Исполнители.Имя = 'Король и Шут';
